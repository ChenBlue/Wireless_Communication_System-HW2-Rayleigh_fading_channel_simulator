# Wireless_Communication_System-HW2-Rayleigh_fading_channel_simulator
This is the homework from COM5170 Wireless Communication in National Tsing Hua University. We are going to implement a multipath fading channel simulator. There are two parts in this HW: </br>
1. Implement a Rayleigh fading channel simulator based on the Filtered Gaussian Noise method
   * Plot the channel output for fmT = 0.01, 0.1 and 0.5 (t/T = 0 ~ 300)
   * Plot the channel output autocorrelation for fmT = 0.01, 0.1 and 0.5 (fm $\tau$ = 0 ~ 10)
2. Implement a Rayleigh fading channel simulator based on the Sum of Sinusoids method
   * Plot the channel output for M = 8 and 16 (fmT = 0.01, 0.1, 0.5 and t/T = 0 ~ 300)
   * Plot the channel output autocorrelation for M = 8 and 16 (fm $\tau$ = 0 ~10)

## Filtered Gaussian Noise Method
The following picture is the block diagram of Filtered Gaussain Noise Method.
![FGN_Block_diagram](https://github.com/ChenBlue/Wireless_Communication_System-HW2-Rayleigh_fading_channel_simulator/blob/master/FIG/filtered_gaussian_block_diagram.JPG) </br>
Two Gaussian noise source are independent with zero mean and variance $\sigma ^2$. Low-pass filter is first-order low-pass filter. The equation is shown as following:
$$ (g_{I,k+1},g_{Q,k+1})=\xi (g_{I,k},g_{Q,k})+(1-\xi )(w_{I,k},w_{Q,k}) $$
where $(w_{I,k},w_{Q,k})$ are filter input generated by Gaussian noise source. </br>
The coefficient $\xi$ can be derived by following equation:
$$ \xi =2-cos(\frac{\pi f_m T}{2})-\sqrt{(2-cos(\pi f_m T/2))^2 -1} $$
And the variance of Gaussian noise source can be derived by following equation:
$$ \sigma ^2=\frac{1+\xi }{1-\xi }\frac{\Omega _p}{2} $$
where $\Omega _p/2$ is the power spectral densities of noise sources. </br>
After generating g(t), I derive Envelope of the g(t) in dB-scale by $10\times log(\sqrt{g_I (t)^2 +g_Q (t)^2})$.

# Sum of Sinusoids method
Assume channel is stationary and equal strength of multipath components-
$$ g(t)=\sum ^N _{n=1} e ^{j(2\pi f_m tcos\theta _n + \hat{\phi}_n)} $$
For an isotropic scattering environment, assume that the incident angles are uniformly distributed:
$$ \theta _n =\frac{2\pi n}{N}, n=1,2,...,N $$

![FGN_Block_diagram](https://github.com/ChenBlue/Wireless_Communication_System-HW2-Rayleigh_fading_channel_simulator/blob/master/FIG/freq_pair.JPG) </br>

Based on the figure above, we can see that some frequencies are the same. Therefore, we can rewrite the equation as following.
$$ g(t)=g_I (t)+jg_Q (t)=sqrt{2}\{[2\sum ^M _{n=1}(cos\beta _n cos2\pi f_n t)+\sqrt{2}cos\alpha cos2\pi f_m t]+j[2\sum ^M _{n=1} (sin\beta _n cos2\pi f_n t)+\sqrt(2) sin\alpha cos2\pi f_m t]\} $$
where $\alpha = \hat{\phi}_N =-\hat{\phi}_{-N},\beta _n =\hat{\phi}_n =-\hat{\phi}_{-N}, M=\frac{1}{2}(\frac{N}{2}-1) $
